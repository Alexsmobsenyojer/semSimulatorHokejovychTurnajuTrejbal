<Window x:Class="semSimulatorHokejovychTurnajuTrejbal.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:semSimulatorHokejovychTurnajuTrejbal"
        mc:Ignorable="d"
        Title="Simulátor Hokejových zápasů" Height="800" Width="1200"
        TextElement.Foreground="WhiteSmoke"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Menu Grid.Row="0">
            <MenuItem Header="Soubor">
                <MenuItem Header="Uložit data" Command="{Binding SaveDataCommand}"/>
                <MenuItem Header="Načíst data" Command="{Binding LoadDataCommand}"/>
                <Separator/>
                <MenuItem Header="Konec" Command="{Binding ExitCommand}"/>
            </MenuItem>
            <MenuItem Header="Možnosti">
                <MenuItem Header="Smazat databázi" Command="{Binding DeleteDatabaseCommand}"/>
            </MenuItem>
        </Menu>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0">
                <StackPanel Margin="10">
                    <TextBlock Text="Výpis dat (edit dvojklikem)" Foreground="RoyalBlue" FontWeight="Bold" HorizontalAlignment="Center"/>
                    <Button Content="Vytvořit" Command="{Binding CreateEntityCommand}" CommandParameter="{Binding SelectedEntityType}" Margin="0,0,0,10"/>
                    <TextBox Text="{Binding FilterText, UpdateSourceTrigger=PropertyChanged}"/>
                    <!--<Button Content="Filtrovat" Command="{Binding FilterCommand}" Margin="0,0,0,10"/>-->
                    <DataGrid Grid.Column="0" ItemsSource="{Binding Players}" SelectedItem="{Binding SelectedPlayer}" AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="True" Margin="10">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" IsReadOnly="True" Width="50"/>
                            <DataGridTextColumn Header="Jméno" Binding="{Binding FullName}" Width="100"/>
                            <DataGridTextColumn Header="Číslo" Binding="{Binding Number}" Width="50"/>
                            <DataGridTextColumn Header="Pozice" Binding="{Binding Position}" Width="50"/>
                            <DataGridTextColumn Header="Role" Binding="{Binding Role}" Width="80"/>
                            <DataGridTextColumn Header="Střelba" Binding="{Binding Shooting}" Width="50"/>
                            <DataGridTextColumn Header="Přihrávky" Binding="{Binding Passing}" Width="50"/>
                            <DataGridTextColumn Header="Obrana" Binding="{Binding Defending}" Width="50"/>
                            <DataGridTextColumn Header="Bruslení" Binding="{Binding Skating}" Width="50"/>
                            <DataGridTextColumn Header="Celk. Hodnocení" Binding="{Binding Overall}" Width="50"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    
                    <DataGrid Grid.Column="1" ItemsSource="{Binding Teams}" SelectedItem="{Binding SelectedTeam}" AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="True" Margin="10">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" IsReadOnly="True" Width="50"/>
                            <DataGridTextColumn Header="Název" Binding="{Binding Name}" Width="250"/>
                            <DataGridTextColumn Header="Výhry" Binding="{Binding Wins}" Width="80"/>
                            <DataGridTextColumn Header="Prohry" Binding="{Binding Losses}" Width="80"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <DataGrid Grid.Column="2" ItemsSource="{Binding Tournaments}" SelectedItem="{Binding SelectedTournament}" AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="True" Margin="10">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" IsReadOnly="True" Width="50"/>
                            <DataGridTextColumn Header="Název" Binding="{Binding Title}" Width="300"/>
                            <DataGridTextColumn Header="Týmů" Binding="{Binding TeamIds.Count}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </Border>

            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Border Grid.Row="0" CornerRadius="8" Margin="10" Padding="10" BorderBrush="Gray" BorderThickness="4">
                    <Viewbox>    
                        <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                            <TextBlock Text="{Binding HomeTeamName}" Grid.Row="0" Grid.Column="0" Foreground="Black" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <TextBlock Text="{Binding AwayTeamName}" Grid.Row="0" Grid.Column="4" Foreground="Black" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center"/>

                            <TextBlock Text="{Binding HomeScore}" Grid.Row="0" Grid.Column="1" Foreground="#FFD700" FontSize="48" FontWeight="Bold" Margin="20,0"/>
                            <TextBlock Text="{Binding AwayScore}" Grid.Row="0" Grid.Column="3" Foreground="#FFD700" FontSize="48" FontWeight="Bold" Margin="20,0"/>

                            <StackPanel Grid.Row="0" Grid.Column="2" VerticalAlignment="Center" Margin="20,0">
                                <TextBlock Text="{Binding GameTime}" Foreground="Red" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <TextBlock Text="{Binding PeriodText}" Foreground="Black" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center"/>
                            </StackPanel>

                            <TextBlock Text="SHOTS" Grid.Row="1" Grid.Column="0"  Foreground="Gray" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <TextBlock Text="{Binding HomeShots}" Grid.Row="1" Grid.Column="1" Foreground="Black" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="20,5"/>
                            <TextBlock Text="{Binding AwayShots}" Grid.Row="1" Grid.Column="3" Foreground="Black" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="20,5"/>
                            <TextBlock Text="SHOTS" Grid.Row="1" Grid.Column="4"  Foreground="Gray" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Grid>
                    </Viewbox>
                </Border>

                <DockPanel Grid.Row="1" HorizontalAlignment="Center" Margin="1">
                    <Button Command="{Binding StartSimulationCommand}" ToolTip="Začít Simulaci">
                        <Viewbox Width="16" Height="16">
                            <Path Fill="DimGray" Data="M 0,0 L 0,12 L 10,6 Z" Margin="1"/>
                        </Viewbox>
                    </Button>
                    <Button Command="{Binding StopSimulationCommand}" ToolTip="Zastavit Simulaci">
                        <Viewbox Width="16" Height="16">
                            <Path Fill="DimGray" Data="M 0,0 H 12 V 12 H 0 Z" Margin="3" />
                        </Viewbox>
                    </Button>
                    <Button Command="{Binding SkipSimulationCommand}" ToolTip="Přeskočit simulaci">
                        <Viewbox Width="16" Height="16" >
                            <Path Fill="DimGray" Data="M 0,0 V 12 L 7,6 Z M 8,0 V 12 L 15,6 Z" Margin="1" />
                        </Viewbox>
                    </Button>
                </DockPanel>
                <Border Grid.Row="2" CornerRadius="8" Margin="10">
                    <Viewbox>
                    <Canvas x:Name="RinkCanvas" Background="Transparent" Width="400" Height="700" >

                        <!-- Rink Outline -->
                        <Rectangle Width="400" Height="700" Stroke="Black" StrokeThickness="8" RadiusX="80" RadiusY="80" Panel.ZIndex="2"/>

                        <!-- Goal Lines -->
                        <Line X1="5" Y1="70" X2="395" Y2="70" Stroke="#F85D59" StrokeThickness="8" Panel.ZIndex="1"/>
                        <Line X1="5" Y1="630" X2="395" Y2="630" Stroke="#F85D59" StrokeThickness="8" Panel.ZIndex="1"/>

                        <!-- Goal Creases -->
                        <Path Stroke="#F85D59" StrokeThickness="1" Fill="#B0E0E6">
                            <Path.Data>
                                <PathGeometry>
                                    <PathFigure StartPoint="160,70">
                                        <ArcSegment Point="240,70" Size="40,40" SweepDirection="Counterclockwise"/>
                                    </PathFigure>
                                </PathGeometry>
                            </Path.Data>
                        </Path>
                        <Path Stroke="#F85D59" StrokeThickness="1" Fill="#B0E0E6">
                            <Path.Data>
                                <PathGeometry>
                                    <PathFigure StartPoint="160,630">
                                        <ArcSegment Point="240,630" Size="40,40" SweepDirection="Clockwise"/>
                                    </PathFigure>
                                </PathGeometry>
                            </Path.Data>
                        </Path>

                        <!-- Goal Nets -->
                        <Rectangle Width="60" Height="30" Canvas.Left="170" Canvas.Top="35" Stroke="#F85D59" StrokeThickness="3"/>
                        <Rectangle Width="60" Height="30" Canvas.Left="170" Canvas.Top="635" Stroke="#F85D59" StrokeThickness="3"/>

                        <!-- Center Line -->
                        <Line X1="0" Y1="350" X2="400" Y2="350" Stroke="#F85D59" StrokeThickness="8"/>

                        <!-- Blue Lines -->
                        <Line X1="0" Y1="250" X2="400" Y2="250" Stroke="#2A8ACB" StrokeThickness="8"/>
                        <Line X1="0" Y1="450" X2="400" Y2="450" Stroke="#2A8ACB" StrokeThickness="8"/>

                        <!-- Center Circle -->
                        <Ellipse Width="75" Height="75" Canvas.Left="162.5" Canvas.Top="312.5" Stroke="#2A8ACB" StrokeThickness="6"/>
                        <Ellipse Width="10" Height="10" Canvas.Left="195" Canvas.Top="345" Fill="Red"/>

                        <!-- Faceoff circles -->
                        <Ellipse Width="65" Height="65" Canvas.Left="75" Canvas.Top="145" Stroke="#F85D59" StrokeThickness="6"/>
                        <Ellipse Width="10" Height="10" Canvas.Left="102" Canvas.Top="172" Fill="Red"/>

                        <Ellipse Width="65" Height="65" Canvas.Left="275" Canvas.Top="145" Stroke="#F85D59" StrokeThickness="6"/>
                        <Ellipse Width="10" Height="10" Canvas.Left="302" Canvas.Top="172" Fill="Red"/>

                        <Ellipse Width="65" Height="65" Canvas.Left="75" Canvas.Top="505" Stroke="#F85D59" StrokeThickness="6"/>
                        <Ellipse Width="10" Height="10" Canvas.Left="102" Canvas.Top="532" Fill="Red"/>

                        <Ellipse Width="65" Height="65" Canvas.Left="275" Canvas.Top="505" Stroke="#F85D59" StrokeThickness="6"/>
                        <Ellipse Width="10" Height="10" Canvas.Left="302" Canvas.Top="532" Fill="Red"/>

                        <!-- Neutral Zone Dots -->
                        <Ellipse Width="10" Height="10" Canvas.Left="95" Canvas.Top="270" Fill="Red"/>
                        <Ellipse Width="10" Height="10" Canvas.Left="295" Canvas.Top="270" Fill="Red"/>
                        <Ellipse Width="10" Height="10" Canvas.Left="95" Canvas.Top="420" Fill="Red"/>
                        <Ellipse Width="10" Height="10" Canvas.Left="295" Canvas.Top="420" Fill="Red"/>
                        <!-- Goal Popup -->
                        <Border Background="#CC000000" Canvas.Left="115" Canvas.Top="178" CornerRadius="12" Padding="20" Margin="0,80,0,0" Panel.ZIndex="3" Opacity="0">
                            <Border.Effect>
                                <DropShadowEffect Color="blue" ShadowDepth="3" BlurRadius="30"/>
                            </Border.Effect>
                            <StackPanel TextBlock.Foreground="White" TextBlock.FontSize="18" TextBlock.FontWeight="Bold">
                                <TextBlock x:Name="GoalText" Text="GÓL!" FontSize="36" HorizontalAlignment="Center" Foreground="#FFD700"/>
                                <TextBlock Text="{Binding CurrentGoal.Scorer.FullName}" HorizontalAlignment="Center" Margin="0,5"/>
                                <TextBlock Text="Asistence:" HorizontalAlignment="Center" FontStyle="Italic" FontSize="16"/>
                                <TextBlock Text="{Binding CurrentGoal.Assist1.FullName}" HorizontalAlignment="Center" FontStyle="Italic" FontSize="16"/>
                                <TextBlock Text="{Binding CurrentGoal.Assist2.FullName}" HorizontalAlignment="Center" FontStyle="Italic" FontSize="16"/>
                            </StackPanel>
                        </Border>
                    </Canvas>
                </Viewbox>
            </Border>
            </Grid>

            <Border Grid.Column="2">
                <StackPanel>
                    <TextBlock Text="Statistiky hráčů" FontWeight="Bold" HorizontalAlignment="Center" Foreground="RoyalBlue" Margin="2"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <RadioButton Content="Domácí" IsChecked="{Binding ShowHomeStats}" GroupName="TeamStats"/>
                        <RadioButton Content="Hosté" IsChecked="{Binding ShowAwayStats}" GroupName="TeamStats" Margin="10,0"/>
                    </StackPanel>
                    <ListView ItemsSource="{Binding SkaterStats}" Height="300" >
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Hráč" Width="150" DisplayMemberBinding="{Binding FullName}"/>
                                <GridViewColumn Header="Góly" Width="75" DisplayMemberBinding="{Binding Goals}"/>
                                <GridViewColumn Header="Asistence" Width="75" DisplayMemberBinding="{Binding Assists}"/>
                                <GridViewColumn Header="Střely" Width="75" DisplayMemberBinding="{Binding Shots}"/>
                            </GridView>
                        </ListView.View>
                    </ListView>
                    <ListView ItemsSource="{Binding GoalieStats}" Height="100" >
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Hráč" Width="150" DisplayMemberBinding="{Binding FullName}"/>
                                <GridViewColumn Header="Zásahy" Width="75" DisplayMemberBinding="{Binding Saves}"/>
                                <GridViewColumn Header="Obdržené góly" Width="75" DisplayMemberBinding="{Binding GoalsAgainst}"/>
                                <GridViewColumn Header="Úspěšnost zákroků" Width="75" DisplayMemberBinding="{Binding SavePercentage, StringFormat=F2}"/>
                            </GridView>
                        </ListView.View>
                    </ListView>
                    <TextBlock Text="Zápasy turnaje" FontWeight="Bold" HorizontalAlignment="Center" Foreground="RoyalBlue" Margin="2"/>
                    <ListBox ItemsSource="{Binding CurrentMatches}" SelectedItem="{Binding SelectedMatch}" Height="250">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding}" FontWeight="SemiBold"/>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </StackPanel>
            </Border>
        </Grid>

        <StatusBar Grid.Row="2">
            <StatusBarItem>
                <TextBlock Text="{Binding StatusText}"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>